package immigrants;

import immigrants.Immigrant.SomeNames;

import java.util.ArrayList;
import java.util.Random;

public class Demo {

	public static void main(String[] args) {
		
		
		Country country = new Country("England",5);
		ArrayList<Immigrant> newWave = new ArrayList<Immigrant>();
		
		for (int i = 0; newWave.size() <= 100; i++) {
			int newPercent = new Random().nextInt(100);
			if(newPercent<25) {
				Radical rad = new Radical(SomeNames.values()[new Random().nextInt(SomeNames.values().length)].toString()
						,new Random().nextInt(500));
				int chancePassport = new Random().nextInt(100);
				if(chancePassport<35) {
				rad.setPassport(new Passport(rad.getName(),new Random().nextInt(80),rad.getCity(),rad.getCountry()));
				if(newWave.size()<3) {
					rad.setRelative(new Radical(SomeNames.values()[new Random().nextInt(SomeNames.values().length)].toString()
							,new Random().nextInt(500)));
					rad.setRelative(new Radical(SomeNames.values()[new Random().nextInt(SomeNames.values().length)].toString()
							,new Random().nextInt(500)));
				}
				else {
				int countRelatives=0;
				while(countRelatives<2) {
				Immigrant relative = newWave.get(new Random().nextInt(newWave.size()-1));
				if(!relative.equals(rad)) {
				rad.setRelative(relative);
				countRelatives++;
						}
					}
				}
				newWave.add(rad);
				
			}
		}
			else if(newPercent<60) {
				Extremist ext = new Extremist(SomeNames.values()[new Random().nextInt(SomeNames.values().length)].toString()
						,new Random().nextInt(500));
				if(newWave.size()<3) {
					ext.setRelative(new Extremist(SomeNames.values()[new Random().nextInt(SomeNames.values().length)].toString()
							,new Random().nextInt(500)));
					ext.setRelative(new Extremist(SomeNames.values()[new Random().nextInt(SomeNames.values().length)].toString()
							,new Random().nextInt(500)));
				}
				else {
				int countRelatives=0;
				while(countRelatives<2) {
				Immigrant relative = newWave.get(new Random().nextInt(newWave.size()-1));
				if(!relative.equals(ext)) {
					ext.setRelative(relative);
				countRelatives++;
						}
					}
				}
				newWave.add(ext);
			}
			else if(newPercent<100) {
				Normal nor = new Normal(SomeNames.values()[new Random().nextInt(SomeNames.values().length)].toString()
						,new Random().nextInt(500));
				nor.setPassport(new Passport(nor.getName(),new Random().nextInt(80),nor.getCity(),nor.getCountry()));
				if(newWave.size()<3) {
					nor.setRelative(new Normal(SomeNames.values()[new Random().nextInt(SomeNames.values().length)].toString()
							,new Random().nextInt(500)));
					nor.setRelative(new Normal(SomeNames.values()[new Random().nextInt(SomeNames.values().length)].toString()
							,new Random().nextInt(500)));
				}
				else {
				int countRelatives=0;
				while(countRelatives<2) {
				Immigrant relative = newWave.get(new Random().nextInt(newWave.size()-1));
				if(!relative.equals(nor)) {
					nor.setRelative(relative);
				countRelatives++;
						}
					}
				}
				newWave.add(nor);
			}
		}
		
		ArrayList<Weapon> newWeapons = new ArrayList<Weapon>();
		for (int i = 0; newWeapons.size() <=200; i++) {
			int chanceToGetWeapon = new Random().nextInt(3);
			switch (chanceToGetWeapon) {
			case 0 : Weapon weapon = new Pistol(new Random().nextInt(300)+200,new Random().nextInt(200));
			newWeapons.add(weapon);
			break;
			case 1 : Weapon weapon1 = new Bomb(new Random().nextInt(1000)+500,new Random().nextInt(5));
			newWeapons.add(weapon1);
			break;
			case 2 : Weapon weapon2 = new Automat(new Random().nextInt(400)+300,new Random().nextInt(350));
			newWeapons.add(weapon2);
			break;
			}
		}
		for (int i = 0; i < newWave.size(); i++) {
			for(int j=0;j<5;j++) {
			try { int weaponIDX = new Random().nextInt(newWeapons.size());
				newWave.get(i).buyWeapon(newWeapons.get(weaponIDX));
				 newWeapons.remove(weaponIDX);
				}
			catch(Exception e) {
				System.out.println("Immigrant dies from anger and leaves newWave of Immigrants");
				newWave.remove(i);
				break;
				}
			}
		}
		
		for (int i = 0; i < newWave.size(); i++) {
			newWave.get(i).immigrateTo(country,country.getCity());
		}
		for (int i = 0; i < newWave.size(); i++) {
			System.out.println(newWave.get(i));
		}
		for (int i = 0; i < 20; i++) {
			newWave.get(new Random().nextInt(newWave.size())).fire();
		}
		
		getSortedSurvivalCities();
		getSortedMoneyImmigrants();
		getExplodedBombImmigrants();
		

	}
}
